<!DOCTYPE html>
<html>
   <head>
      <title>Readysaster App</title>
      <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" >
      <meta charset="utf-8">
      <link rel="stylesheet" href="css/bootstrap.min.css" media="screen">
      <style>
         body {
         background:#ddd;
         }
      </style>
   </head>
   <body>
      <div class="navbar navbar-default">
         <br>
         <div class="text-center" style="vertical-align:middle"><img src="images/banner.png" style="max-width:60%;"></div>
         <br>
      </div>
      <div id="loadingtext" class="text-center center-block" style="max-width:640px;">
         <img src="images/tagline.png" style="width:85%;padding-bottom: 10px">
         <h3><img id="imgloader" src="images/ajax-loader.gif" style="width:32px;opacity:0.5;vertical-align:middle;-webkit-border-radius:40px;border-radius: 40px;">&nbsp;<b>Loading...</b></h3>
         <br>
      </div>
      <div class="container">
         <div style="max-width:640px;margin-left:auto;margin-right:auto;">
            <!--Always Insert Content Here - START HERE-->
            <!-- Offline Mode Alert - START -->
            <div class="alert alert-info offlinemodeind" style="display:none">
               <b>Offline Mode Activated</b><br>
               <span class="pull-right" style="margin-left:10px;font-size:3em"><span class="glyphicon glyphicon-info-sign"></span></span>
               <small>We saw that you are disconnected to the internet, so we made iLigtas App suitable for those who are offline</small>
               <span class="clearfix"></span>
            </div>
            <!-- Offline Mode Alert - END -->
            <!--login container start-->
            <div id="logincont" style="display:none">
               <div class="text-center"><img src="images/logo-mobileapp.png" style="width:50%;padding-bottom: 10px"><br><img id="tagline" src="images/tagline.png" style="display:none;width:100%;padding-bottom: 10px"></div>
               <div class="panel panel-default">
                  <div class="panel-body">
                     <form id="loginform" action="javascript:verifyfirst()">
                        <div class="input-group"  style="margin-bottom:2px;">
                           <span class="input-group-addon"><span class="glyphicon glyphicon-user"></span></span>
                           <input type="text" class="form-control" name="username" id="username" placeholder="Username">
                        </div>
                        <div class="input-group" style="margin-bottom:10px;">
                           <span class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span>
                           <input type="password" class="form-control" name="pass" id="lpass" placeholder="Password" >
                        </div>
                        <input type="submit" value="Log In" id="btnlogin" class="btn btn-warning btn-block">
                     </form>
                  </div>
               </div>
               <a href = "javascript:opencloseregistration();" class="btn btn-success btn-block"><span class="glyphicon glyphicon-pencil"></span>&nbsp;&nbsp;Register for iLigtas Account</a>
            </div>
            <!--login container end-->
            <!--registration container start-->
            <div id="regcont" style="display:none">
               <div class="panel panel-primary">
                  <div class="panel-heading"><b>Register for iLigtas Account</b></div>
                  <div class="panel-body">
                     <div class="alert alert-danger">
                        <b>Warning</b><br>
                        <span class="pull-right" style="margin-left:10px;font-size:3em"><span class="glyphicon glyphicon-warning-sign"></span></span>
                        <small>The Information you will input is essential in saving lives, Please input your information correctly.</small>
                        <span class="clearfix"></span>
                     </div>
                     <small>* indicates required fields</small>
                     <form id="signupform" action="javascript:registeruser();">
                        <b>Full Name*:</b>
                        <input type="text" class="form-control" name="fullname" id="fullname" maxlength="150">
                        <small id="errorfullname" style="color:#ff0000;display:block"></small>
                        <b>Organization / Institution:</b>
                        <input type="text"  class="form-control" name="org" id="org" maxlength="50">
                        <small id="errororg" style="color:#ff0000;display:block"></small>
                        <!-- Address Panel Start -->
                        <b>Address*:</b>
                        <div class="panel panel-default">
                           <div class="panel-body">
                              <b>Number, Street, Baranggay/Subdivision:</b>
                              <input type="text" placeholder="e.g. #32-B Flores Street, New Kalalake"  class="form-control" name="numstreet" id="numstreet" maxlength="50">
                              <small id="errornumstreet" style="color:#ff0000;display:block"></small>
                              <b>City:</b>
                              <input type="text" placeholder="e.g. Olongapo City"  class="form-control" name="city" id="city" maxlength="50">
                              <small id="errorcity" style="color:#ff0000;display:block"></small>
                           </div>
                        </div>
                        <!-- Address Panel End -->
                        <b>Mobile Number*:</b>
                        <small style="color:#2373a5"><br>Please use the format 639xxxxxxxxx</small>
                        <input type="text"  class="form-control" name="mobile" id="mobile" maxlength="12">
                        <small id="errormobile" style="color:#ff0000;display:block"></small>
                        <b>E-Mail*:</b>
                        <input type="email"  class="form-control" name="email" id="email" maxlength="50">
                        <small id="erroremail" style="color:#ff0000;display:block"></small>
                        <b>Username*:</b>
                        <small style="color:#2373a5"><br>8-15 Characters, Alphanumeric Characters</small>
                        <input type="text" class="form-control" name="username" id="username" maxlength="15">
                        <small id="errorusername" style="color:#ff0000;display:block"></small>
                        <b>Password*:</b>
                        <small style="color:#2373a5"><br>8-15 Characters, Alphanumeric Characters</small>
                        <input type="password" class="form-control" name="pass" id="pass" maxlength="15">
                        <small id="errorpass" style="color:#ff0000;display:block"></small>
                        <b>Confirm Password*:</b>
                        <input type="password" class="form-control" name="cpass" id="cpass" maxlength="15">
                        <small id="errorcpass" style="color:#ff0000;display:block"></small>
                        <b>Gender*:</b>
                        <br>
                        <fieldset class="btn-group" data-toggle="buttons">
                           <label class="btn btn-success"><input type="radio" name="gender" id="rchoicemale" value="m">
                           Male</label>
                           <label class="btn btn-success"><input type="radio" name="gender"  id="rchoicefemale" value="f">
                           Female</label>
                        </fieldset>
                        <br><small id="errorgender" style="color:#ff0000;display:block"></small><br>
                        <b>Birthdate*:</b><br>
                        <fieldset class="form-inline">
                           <select name="bdaym" id="mbirth" style="height:40px">
                              <option value="01">January</option>
                              <option value="02">February</option>
                              <option value="03">March</option>
                              <option value="04">April</option>
                              <option value="05">May</option>
                              <option value="06">June</option>
                              <option value="07">July</option>
                              <option value="08">August</option>
                              <option value="09">September</option>
                              <option value="10">October</option>
                              <option value="11">November</option>
                              <option value="12">December</option>
                           </select>
                           &nbsp;&nbsp;&nbsp;&nbsp;
                           <select name="bdayd" id="dbirth" style="height:40px;width:60px">
                              <option value="1">1</option>
                              <option value="2">2</option>
                              <option value="3">3</option>
                              <option value="4">4</option>
                              <option value="5">5</option>
                              <option value="6">6</option>
                              <option value="7">7</option>
                              <option value="8">8</option>
                              <option value="9">9</option>
                              <option value="10">10</option>
                              <option value="11">11</option>
                              <option value="12">12</option>
                              <option value="13">13</option>
                              <option value="14">14</option>
                              <option value="15">15</option>
                              <option value="16">16</option>
                              <option value="17">17</option>
                              <option value="18">18</option>
                              <option value="19">19</option>
                              <option value="20">20</option>
                              <option value="21">21</option>
                              <option value="22">22</option>
                              <option value="23">23</option>
                              <option value="24">24</option>
                              <option value="25">25</option>
                              <option value="26">26</option>
                              <option value="27">27</option>
                              <option value="28">28</option>
                              <option value="29">29</option>
                              <option value="30">30</option>
                              <option value="31">31</option>
                           </select>
                           &nbsp;&nbsp;&nbsp;&nbsp;
                           <select name="bdayy" id="ybirth" style="height:40px;width:80px">
                              <option value="1960">1960</option>
                              <option value="1961">1961</option>
                              <option value="1962">1962</option>
                              <option value="1963">1963</option>
                              <option value="1964">1964</option>
                              <option value="1965">1965</option>
                              <option value="1966">1966</option>
                              <option value="1967">1967</option>
                              <option value="1968">1968</option>
                              <option value="1969">1969</option>
                              <option value="1970">1970</option>
                              <option value="1971">1971</option>
                              <option value="1972">1972</option>
                              <option value="1973">1973</option>
                              <option value="1974">1974</option>
                              <option value="1975">1975</option>
                              <option value="1976">1976</option>
                              <option value="1977">1977</option>
                              <option value="1978">1978</option>
                              <option value="1979">1979</option>
                              <option value="1980">1980</option>
                              <option value="1981">1981</option>
                              <option value="1982">1982</option>
                              <option value="1983">1983</option>
                              <option value="1984">1984</option>
                              <option value="1985">1985</option>
                              <option value="1986">1986</option>
                              <option value="1987">1987</option>
                              <option value="1988">1988</option>
                              <option value="1989">1989</option>
                              <option value="1990">1990</option>
                              <option value="1991">1991</option>
                              <option value="1992">1992</option>
                              <option value="1993">1993</option>
                              <option value="1994">1994</option>
                              <option value="1995">1995</option>
                              <option value="1996">1996</option>
                              <option value="1997">1997</option>
                              <option value="1998">1998</option>
                              <option value="1999">1999</option>
                              <option value="2000">2000</option>
                              <option value="2001">2001</option>
                              <option value="2002">2002</option>
                              <option value="2003">2003</option>
                              <option value="2004">2004</option>
                              <option value="2005">2005</option>
                              <option value="2006">2006</option>
                              <option value="2007">2007</option>
                              <option value="2008">2008</option>
                              <option value="2009">2009</option>
                              <option value="2010">2010</option>
                              <option value="2011">2011</option>
                              <option value="2012">2012</option>
                              <option value="2013">2013</option>
                           </select>
                        </fieldset>
                     </form>
                  </div>
               </div>
               <div class="text-center">By Submitting, you automatically agree to the <a href="javascript:openterms();" class="btn btn-primary btn-xs" style="text-decoration:none">Terms and Conditions</a></div>
               <br>
               <input type="submit" class="btn btn-warning btn-block" value="Submit" id="btnsubmit" form="signupform">
               <a href = "javascript:opencloseregistration();" class="btn btn-primary btn-block">Cancel</a>
            </div>
            <div class="text-center"><br>iLigtas | READYSASTER 2014<br></div>
            <!-- DO NOT REMOVE THIS - Used to Determine Online from Offline Mode-->
            <div class="offlinemodeind text-center" style="display:none"><span class="label label-info">OFFLINE MODE ACTIVATED</span></div>
            <!--Always Insert Content Here - END HERE-->
         </div>
         <br>
      </div>
      <!--- Error Modal Start -->
      <div class="modal fade" id="errormodal" tabindex="-1" role="dialog" aria-hidden="true">
         <div class="modal-dialog modal-vertical-centered">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h4 id="popuptitle" class="modal-title"></h4>
               </div>
               <div class="modal-body">
                  <p id="popuptext"></p>
               </div>
            </div>
         </div>
      </div>
      <!--- Error Modal End -->
	  <!--- Terms and Conditions Modal Start -->
      <div class="modal fade" id="termsmodal" tabindex="-1" role="dialog" aria-hidden="true">
         <div class="modal-dialog">
            <div class="modal-content">
               <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h4 class="modal-title">Terms and Conditions</h4>
               </div>
               <div class="modal-body">
                  <h2 class="text-center">Terms and Conditions</h2>
					<p align="justify">
						<b>In using this application you are deemed to have read and agreed to the following terms and conditions:</b>
						<br>
						This application <b>MUST</b> be used <b>ONLY</b> for the <b>PURPOSE</b> of <b>Disaster Risk Reduction, Response and Management</b>. We constantly review our systems and data to ensure the best possible service to you. The Government has created specific offences for unauthorized actions against computer systems and data. We will investigate any such actions with a view to prosecuting and/or taking civil proceedings to recover damages against those responsible.
						<br>
						<h4>Acceptable Use</h4>
						You shall not do any of the following or permit any other third parties to do any of the following:
						<ol type="a">
							<li>Post or transmit any unlawful, deceiving, threatening, abusive, profane information of any kind, including, without limitation, any transmission constituting or encouraging conduct that would constitute a criminal offense, give rise to civil liability, or otherwise violate any local, provincial, state, national or international law and regulations.</li>
							<li>Post or transmit any information or software that the sender is aware contains a virus, worm, or other harmful component.</li>
						</ol>
						You have an <b>AFFIRMATIVE OBLIGATION</b> to provide the application with correct information. You agree to provide true, accurate, current and complete information and to maintain and promptly update your information as necessary. You agree not to impersonate any other person you are not authorized to use.
						<br><br>
						<p class="text-center">&copy; iLigtas May 2014. All Rights Reserved</p>
					</p>
               </div>
            </div>
         </div>
      </div>
      <!--- Terms Modal End -->
      <script src="js/jquery-1.10.2.min.js"></script>
      <script src="js/bootstrap.min.js"></script>
      <script type="text/javascript" src="js/jquery.validate.js"></script>
      <script>
         var form = $("#signupform");
         form.validate({
         				errorPlacement: function ($error, $element) {
         					var name = $element.attr("name");
         					$("#error" + name).html($error);
         				},
         				rules: {
         					fullname: {
         						required: true,
         						minlength: 1
         					},
         					numstreet: {
         						required: true
         					},
         					city: {
         						required: true
         					},
         					email: {
         						required: true,
         						email: true
         					},
         					mobile: {
         						required: true,
         						number: true
         					},
         					username: {
         						required: true,
         						minlength: 8
         					},
         					pass: {
         						required: true,
         						minlength: 8
         					},
         					cpass: {
         						required: true,
         						minlength: 8,
         						equalTo: "#pass"
         					},
         					gender: {
         						required: true
         					}
         				},
         				messages: {
         					fullname: {
         						required: "Please enter your Full Name"
         					},
         					numstreet: "Please enter a valid Address",
         					city: "Please enter a valid City",
         					email: "Please enter a valid email address",
         					mobile: "Please enter a valid Mobile number",
         					username: {
         						required: "Please enter a valid username",
         						minlength: "Your username must be at least 8 characters long"
         					},
         					pass: {
         						required: "Please provide a password",
         						minlength: "Your password must be at least 8 characters long"
         					},
         					cpass: {
         						required: "Please provide a password",
         						minlength: "Your password must be at least 8 characters long",
         						equalTo: "Passwords does not match"
         					},
         					gender: {
         						required: "Please specify your gender"
         					}
         				}
         		});
         // login verification function
         var lform = $("#loginform");
         		function verifyfirst(){
         		if($( "#lusername" ).val() == "" || $( "#lpass" ).val() == "")
         		{
         		return;
         		}
         			$('#loadingmodal').modal({backdrop: "static",keyboard: false},'show');
         		
         			$.getJSON("http://gcccs.org/iligtas/verifyfirst.php?callback=?", lform.serialize(),function(data)
         			{
         				if (data.verified == "v1")
         				{
         				localStorage.setItem("datauser", data.username);
         				location.href="home.html";
         				$('#loadingmodal').modal("hide");
         				}
         				else
         				{
         				$('#loadingmodal').modal("hide");
         				$("#popuptitle").html("Unable to Login");
         				$("#popuptext").html("<b>The account you've entered is not associated with iLigtas. Please check your username or password.</b>");
         				$('#errormodal').modal('show');
         				}
         			}).fail(function(data){
         				$('#loadingmodal').modal("hide");
         				$("#popuptitle").html("Unable to Login");
         				$("#popuptext").html("<b>There is a problem with your login, please try again later.</b>");
         				$('#errormodal').modal('show');
         				
         			});
         		}
         //registration for user accounts function
         function registeruser()
         		{
         		//checks if form is valid
         		if(form.valid)
         			{	
         			$('#loadingmodal').modal({backdrop: "static",keyboard: false},'show');
         			// validate if email and/or username exists in the database
         				$.getJSON("http://gcccs.org/iligtas/emailval.php?callback=?", form.serialize() ,function(data)
         				{
         				// eexists = email exists
         				if(data.eexists =="exists")
         				{
         				$("body").scrollTop($("#email").offset().top);
         				$("#erroremail").text("");
         				$("#erroremail").append("E-mail <b>"+ data.email + "</b> is already in use, use another e-mail<br>");
         				}
         				// uexists = username exists
         				else if(data.uexists =="exists")
         				{
         				$("body").scrollTop($("#username").offset().top);
         				$("#errorusename").text("");
         				$("#errorusername").append("Username <b>"+ data.username + "</b> is already in use, use another username<br>");
         				}
         				else
         				{
         				$('#loadingmodal').modal({backdrop: "static",keyboard: false},'show');
         				$.getJSON("http://gcccs.org/iligtas/uregister.php?callback=?", form.serialize(),function(data)
         				{
         					alert("Registration Complete!");
         					location.reload();
         					$('#loadingmodal').modal("hide");
         				}).fail(function(data){
         					alert("Registration Failed!");
         					location.reload();
         					$('#loadingmodal').modal("hide");
         					
         				});
         				}
         				$('#loadingmodal').modal("hide");
         				}).fail(function(data){
         				$('#loadingmodal').modal("hide");
         				$("#popuptitle").html("Unable to Register Account");
         				$("#popuptext").html("There is a problem with your E-mail Address or Username, please try again later.");
         				$('#errormodal').modal('show');
         		});
         			}
         		}
		function openterms()
		  {
		  //Opens the Terms Modal
		   $('#termsmodal').modal('show');
		  }
         function opencloseregistration()
         {
		 //Switches from Login to Registration
         $( "#logincont" ).slideToggle("fast");
         $( "#regcont" ).slideToggle("fast");
         $('body').animate({scrollTop: $( ".navbar" ).offset().top });
         }
         setTimeout(function(){
         if(localStorage.getItem("datauser") === null || localStorage.getItem("datauser") == "") //checks if theres an account logged-in
         	{
         	$( "#loadingtext" ).slideUp("fast"); //hides Loading Text below Header
         	$( "#logincont" ).slideDown("fast"); //shows Login Form Container
         	$( "#tagline" ).delay(250).show("fast"); //Tagline Animation
         	}
         else
         	{
         	location.href="home.html";
         	}
         },1000);
      </script>
   </body>
</html>